# Plan de Pruebas - Telepatía AI Backend API

## 🎯 Objetivo
Implementar un conjunto mínimo de pruebas que se ejecuten automáticamente en cada commit, cubriendo las funcionalidades críticas del proyecto.

## 📋 Estructura de Implementación

### 1. Configuración de Entorno de Pruebas
- Instalar dependencias de testing: `pytest`, `pytest-asyncio`, `httpx`, `pytest-mock`
- Crear archivo `requirements-test.txt`
- Configurar `pytest.ini` con configuración básica

### 2. Estructura de Tests
```
tests/
├── __init__.py
├── conftest.py              # Fixtures compartidas
├── test_health.py           # Tests de health endpoints
├── test_text_processing.py  # Tests de procesamiento de texto
└── test_services.py         # Tests de servicios críticos
```

### 3. Tests Mínimos a Implementar

#### **test_health.py** (2 tests)
- ✅ Test GET /health/ping - respuesta exitosa
- ✅ Test GET /health/db_connection - verifica conexión

#### **test_text_processing.py** (4 tests)
- ✅ Test validación de texto válido
- ❌ Test validación de texto inválido
- ✅ Test simplificación de texto con emojis
- ✅ Test endpoint /message/validate-process-text

#### **test_services.py** (3 tests)
- ✅ Test inicialización de AudioService
- ✅ Test inicialización de GoogleGenAIService
- ✅ Test MessageProcessor básico

### 4. Pre-commit Hook Configuration
- Instalar `pre-commit` framework
- Crear archivo `.pre-commit-config.yaml`
- Configurar hooks para ejecutar tests automáticamente
- Agregar validaciones de formato (opcional)

### 5. Git Hooks
- Crear script `.git/hooks/pre-commit` que ejecute pytest
- Tests deben pasar antes de permitir el commit
- Tiempo de ejecución < 10 segundos

## 🛠️ Archivos a Crear

1. **requirements-test.txt** - Dependencias de testing
2. **pytest.ini** - Configuración de pytest
3. **tests/conftest.py** - Fixtures y configuración global
4. **tests/test_health.py** - Tests de endpoints de salud
5. **tests/test_text_processing.py** - Tests de procesamiento de texto
6. **tests/test_services.py** - Tests de servicios
7. **.pre-commit-config.yaml** - Configuración de pre-commit hooks
8. **.github/workflows/tests.yml** (opcional) - CI/CD con GitHub Actions

## 📊 Criterios de Éxito

- ✅ ~9 tests básicos funcionando
- ✅ Cobertura mínima del 60% en código crítico
- ✅ Tests se ejecutan automáticamente antes de cada commit
- ✅ Tiempo de ejecución < 10 segundos
- ✅ Si algún test falla, el commit se bloquea

## 🚀 Orden de Implementación

### Fase 1: Setup Básico
1. Crear `requirements-test.txt`
2. Crear `pytest.ini`
3. Crear estructura de carpeta `tests/`
4. Crear `conftest.py` con fixtures básicas

### Fase 2: Tests Críticos
1. Implementar `test_health.py`
2. Implementar `test_text_processing.py`
3. Implementar `test_services.py`

### Fase 3: Automatización
1. Crear `.pre-commit-config.yaml`
2. Configurar git hooks
3. Probar ejecución automática
4. Actualizar README.md con instrucciones

## 📝 Notas
- Usar mocks para servicios externos (MongoDB, Google GenAI, ASR)
- Tests deben ser independientes y no requerir servicios reales
- Mantener tests simples y enfocados en un solo comportamiento
- Evitar tests que dependan de servicios externos sin mock

